const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./form1-DakOabcz.js","./index-C9w2uzJU.js","./index-Cbqofex6.css","./form2-D616dqmD.js","./form3-Dk9at06H.js"])))=>i.map(i=>d[i]);
import{d as P,r,c as E,a as v,w as s,b as t,f as D,t as N,u as V,j as g,o as x,g as C,k as T,x as L,i as j,e as M,y as h,z as $,n as q}from"./index-C9w2uzJU.js";import{d as A,g as S}from"./index-BP2T5S1M.js";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang-BuGPOVx1.js";const z=(b,l,u)=>{const n=b[l];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((w,i)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+l+(l.split("/").length!==u?". Note that variables only represent file names one level deep.":""))))})},H=P({__name:"record",setup(b,{expose:l}){const u=r([]),n={1:"同意",2:"拒绝",3:"返回发起人",4:"撤回",5:"同意",6:"同意"},w=m=>{var c;((c=u.value)==null?void 0:c.length)===0&&S("getFlowRecord",{flowId:m}).then(o=>{u.value=o.list})},i=m=>{switch(m){case 1:case 5:return"success";case 2:return"danger";case 3:return"warning";case 4:return"primary";case 6:return"info"}};return l({getData:w}),(m,c)=>{const o=v("el-table-column"),y=v("el-tag"),k=v("el-table");return g(),E(k,{data:u.value},{default:s(()=>[t(o,{label:"审批人",prop:"userName"}),t(o,{label:"节点名称",prop:"nodeName"}),t(o,{label:"处理时间",prop:"dateTime"},{default:s(({row:f})=>[D(N(V(A)(f.dateTime)),1)]),_:1}),t(o,{label:"状态",prop:"status"},{default:s(({row:f})=>[t(y,{type:i(f.status)},{default:s(()=>[D(N(n[f.status]),1)]),_:2},1032,["type"])]),_:1}),t(o,{label:"审批意见",prop:"remark"})]),_:1},8,["data"])}}}),U={key:1},W=P({__name:"flowDetail",props:{detail:{type:Boolean,default:!0}},emits:["submit"],setup(b,{expose:l,emit:u}){const n=b,w=u,i=r(),m=r(),c=r(),o=r();r(!1);const y=r(),k=r({}),f=e=>{y.value=e,S("getFlowById",{id:e}).then(async a=>{k.value=a.nodeStatus,await F(a.flowId),m.value.setValue(JSON.parse(a.formContent))})},F=e=>new Promise((a,_)=>{S("getDesignFlowById",{id:e}).then(async p=>{c.value=p.formType,i.value.render(JSON.parse(p.content)),await B(p),a()})}),B=e=>new Promise(async(a,_)=>{if(e.formType===1){const p=await z(Object.assign({"../../components/flowForm/form1.vue":()=>h(()=>import("./form1-DakOabcz.js").then(d=>d._),__vite__mapDeps([0,1,2]),import.meta.url),"../../components/flowForm/form2.vue":()=>h(()=>import("./form2-D616dqmD.js").then(d=>d._),__vite__mapDeps([3,1,2]),import.meta.url),"../../components/flowForm/form3.vue":()=>h(()=>import("./form3-Dk9at06H.js").then(d=>d._),__vite__mapDeps([4,1,2]),import.meta.url)}),`../../components/flowForm/${e.formId}.vue`,5);o.value=$(p.default),a()}}),O=e=>{w("submit",JSON.stringify(e))},I=r(),R=e=>{q(()=>{e==="flow"&&n.detail?i.value.setStatus(k.value):e==="recoder"&&I.value.getData(y.value)})};return l({getFlowData:f,getFlowDesignDetail:F}),x(()=>{let e="";n.detail&&(e="detail"),window.sessionStorage.setItem("pageType",e)}),(e,a)=>{const _=v("el-tab-pane"),p=v("el-tabs");return g(),C("div",null,[t(p,{onTabChange:R,"model-value":"form"},{default:s(()=>[t(_,{label:"表单",name:"form"},{default:s(()=>[c.value===1?(g(),E(j(o.value),{key:0,ref_key:"flowFormEl",ref:m,disabled:e.detail,onSubmit:O},null,40,["disabled"])):T("",!0),c.value===0?(g(),C("div",U,a[0]||(a[0]=[D("可自行集成ak-design的拖拽表单"),M("br",null,null,-1),D(" https://337547038.github.io/vue-form-design/#/design/form")]))):T("",!0),L(e.$slots,"default")]),_:3}),t(_,{label:"流程图",name:"flow"},{default:s(()=>[t(V(J),{isSilentMode:!0,ref_key:"flowDesignEl",ref:i},null,512)]),_:1}),e.detail?(g(),E(_,{key:0,label:"审批记录",name:"recoder"},{default:s(()=>[t(H,{ref_key:"recoderListEl",ref:I},null,512)]),_:1})):T("",!0)]),_:3})])}}});export{W as _};
