import{_ as W}from"./form1-BfNup6pd.js";import{_ as X}from"./form2-BZ2yhovI.js";import{_ as Y}from"./form3-CDBCPh1d.js";import{d as Z,r as f,l as ee,o as le,g as V,e as C,b as l,w as a,f as u,a as s,c as _,k as T,t as q,u as F,m as te,F as S,h as E,v as ae,E as I,j as d}from"./index-CGLXuONG.js";import{f as j,d as oe,g as x}from"./index-BP2T5S1M.js";const ne={class:"design-list"},se={style:{display:"flex","justify-content":"flex-end",padding:"20px 0"}},ue={style:{display:"flex","justify-content":"flex-end","margin-bottom":"18px"}},ve=Z({__name:"flow",setup(re){const B=f(0),D=f([]),O=o=>{y(o)},L=ee({name:[{required:!0,message:"请输入流程名称",trigger:"blur"}],formType:[{required:!0,message:"请选择表单类型",trigger:"change"}],formId:[{required:!0,message:"请选择表单",trigger:"change"}]}),p=f(!1),n=f({name:"",status:0,formType:0,classify:0}),g=f([]),z=o=>{n.value.formId="",o?N():$()},$=()=>{setTimeout(()=>{g.value=[{label:"请假",value:"1"},{label:"加班",value:"2"},{label:"通用审批",value:"3"},{label:"出差申请",value:"4"}]})},N=()=>{const o=Object.assign({"../components/flowForm/form1.vue":W,"../components/flowForm/form2.vue":X,"../components/flowForm/form3.vue":Y});g.value=[];for(const e in o){const r=o[e].default;g.value.push({label:r.name,value:r.__name})}},J=o=>{p.value=!0,n.value=JSON.parse(JSON.stringify(o)),o.formType===0?$():N()},M=o=>{x("editDesignFlowDel",{id:o.toString()}).then(()=>{I({message:"删除成功",type:"success"}),p.value=!1,y()})},h=()=>{window.location.href="https://337547038.github.io/vue-form-design/#/design/form"},y=(o=1)=>{x("getDesignFlow",{extend:{pageNum:o}}).then(e=>{D.value=e.list})},U=f(),R=async()=>{await U.value.validate((o,e)=>{o&&(n.value.updateTime=new Date().getTime(),x("editDesignFlow",n.value).then(()=>{I({message:"保存成功",type:"success"}),p.value=!1,y()}))})};return le(()=>{y()}),(o,e)=>{const r=s("el-button"),m=s("el-table-column"),c=s("el-tag"),A=s("el-popconfirm"),G=s("el-table"),H=s("el-pagination"),k=s("el-input"),i=s("el-form-item"),b=s("el-option"),w=s("el-select"),K=s("el-switch"),P=s("el-form"),Q=s("el-drawer");return d(),V("div",null,[C("div",ne,[l(r,{type:"primary",onClick:e[0]||(e[0]=t=>o.$router.push({path:"/design"}))},{default:a(()=>e[9]||(e[9]=[u("新增设计")])),_:1}),l(G,{data:D.value,style:{width:"100%"}},{default:a(()=>[l(m,{type:"selection",width:"55"}),l(m,{prop:"name",label:"流程名称"}),l(m,{prop:"code",label:"标识"}),l(m,{prop:"classify",label:"分类"},{default:a(({row:t})=>[t.classify?(d(),_(c,{key:0},{default:a(()=>[u(q(F(j)[t.classify]),1)]),_:2},1024)):T("",!0)]),_:1}),l(m,{prop:"status",label:"状态"},{default:a(({row:t})=>[t.status===1?(d(),_(c,{key:0,type:"primary"},{default:a(()=>e[10]||(e[10]=[u("启用")])),_:1})):T("",!0),t.status===0?(d(),_(c,{key:1,type:"danger"},{default:a(()=>e[11]||(e[11]=[u("禁用")])),_:1})):T("",!0)]),_:1}),l(m,{prop:"updateTime",label:"更新时间",width:"180"},{default:a(({row:t})=>[u(q(F(oe)(t.updateTime)),1)]),_:1}),l(m,{label:"操作",width:"200"},{default:a(t=>[l(r,{link:"",type:"primary",onClick:v=>o.$router.push({path:"/design",query:{id:t.row.id,type:"detail"}})},{default:a(()=>e[12]||(e[12]=[u("查看 ")])),_:2},1032,["onClick"]),l(r,{link:"",type:"primary",onClick:v=>o.$router.push({path:"/design",query:{id:t.row.id}})},{default:a(()=>e[13]||(e[13]=[u("编辑 ")])),_:2},1032,["onClick"]),l(r,{link:"",type:"primary",onClick:v=>J(t.row)},{default:a(()=>e[14]||(e[14]=[u("设置")])),_:2},1032,["onClick"]),l(A,{class:"box-item",title:"确定删除该流程记录吗",placement:"top-start",onConfirm:v=>M(t.row.id)},{reference:a(()=>[l(r,{link:"",type:"danger"},{default:a(()=>e[15]||(e[15]=[u("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),C("div",se,[l(H,{layout:"prev, pager, next",total:B.value,"page-size":20,"current-change":O,"hide-on-single-page":""},null,8,["total"])])]),l(Q,{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=t=>p.value=t),direction:"rtl",size:"500",title:"流程设置"},{default:a(()=>[l(P,{"label-width":"100",model:n.value,rules:L,ref_key:"formEl",ref:U},{default:a(()=>[l(i,{label:"流程名称",prop:"name"},{default:a(()=>[l(k,{placeholder:"请输入流程名称",modelValue:n.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value.name=t)},null,8,["modelValue"])]),_:1}),l(i,{label:"流程标识"},{default:a(()=>[l(k,{placeholder:"请输入流程标识",modelValue:n.value.code,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.code=t)},null,8,["modelValue"])]),_:1}),l(i,{label:"分类"},{default:a(()=>[l(w,{modelValue:n.value.classify,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.classify=t)},{default:a(()=>[(d(!0),V(S,null,E(F(j),(t,v)=>(d(),_(b,{value:parseInt(v.toString()),label:t},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"状态"},{default:a(()=>[l(K,{modelValue:n.value.status,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.status=t),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),l(i,{label:"图标"},{default:a(()=>[l(k,{placeholder:"选择icon图标"})]),_:1}),l(i,{label:"表单类型",prop:"formType"},{default:a(()=>[l(w,{modelValue:n.value.formType,"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.formType=t),onChange:z},{default:a(()=>[l(b,{value:0,label:"在线创建"}),l(b,{value:1,label:"本地表单"})]),_:1},8,["modelValue"])]),_:1}),te(C("div",ue,[l(r,{type:"primary",link:"",onClick:h},{default:a(()=>e[16]||(e[16]=[u("新建表单")])),_:1})],512),[[ae,n.value.formType===0]]),l(i,{label:"选择表单",prop:"form"},{default:a(()=>[l(w,{modelValue:n.value.formId,"onUpdate:modelValue":e[6]||(e[6]=t=>n.value.formId=t)},{default:a(()=>[(d(!0),V(S,null,E(g.value,t=>(d(),_(b,{key:t.value,value:t.value,label:t.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,null,{default:a(()=>[l(r,{type:"primary",onClick:R},{default:a(()=>e[17]||(e[17]=[u("保存")])),_:1}),l(r,{onClick:e[7]||(e[7]=t=>p.value=!1)},{default:a(()=>e[18]||(e[18]=[u("取消")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{ve as default};
