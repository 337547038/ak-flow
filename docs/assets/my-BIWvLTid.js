import{_ as x}from"./flowDetail.vue_vue_type_script_setup_true_lang-BzpLXaMt.js";import{g as b,d as E,b as U,f as $,a as h}from"./index-BP2T5S1M.js";import{d as B,r as c,o as M,g as j,b as a,w as s,a as r,F as S,f as o,t as u,u as m,c as q,k as z,n as I,j as k,E as R}from"./index-C9w2uzJU.js";import"./index.vue_vue_type_script_setup_true_lang-BuGPOVx1.js";const L=B({__name:"my",setup(A){const p=c(),f=c([]),C=t=>`${h().userName}发起的${t.name}`,v=t=>{if(t){const l=[],n=t.split(",");for(const d in n)l.push(_.value[n[d]]);return l.join(",")}return t},w=t=>{switch(t){case 1:return"success";case 2:return"danger";case 3:return"info";case 4:return"warning";default:return"primary"}},i=c(!1),N=t=>{i.value=!0,I(()=>{p.value.getFlowData(t.id)})},_=c({}),g=()=>{b("getMy",{}).then(t=>{f.value=t.list||[],_.value=t.userDict||{}})},D=t=>{b("getCancel",{id:t}).then(l=>{R({message:"撤回成功",type:"success"}),g()})};return M(()=>{g()}),(t,l)=>{const n=r("el-table-column"),d=r("el-tag"),y=r("el-button"),F=r("el-table"),T=r("el-drawer");return k(),j(S,null,[a(F,{data:f.value,style:{width:"100%"}},{default:s(()=>[a(n,{type:"selection",width:"55"}),a(n,{prop:"title",label:"标题",width:"220"},{default:s(({row:e})=>[o(u(C(e)),1)]),_:1}),a(n,{prop:"date",label:"发起时间",width:"180"},{default:s(({row:e})=>[o(u(m(E)(e.startTime)),1)]),_:1}),a(n,{prop:"currentUserId",label:"当前审批人"},{default:s(({row:e})=>[o(u(v(e.currentUserId)),1)]),_:1}),a(n,{prop:"status",label:"状态"},{default:s(({row:e})=>[a(d,{type:w(e.status)},{default:s(()=>[o(u(m(U)[e.status]),1)]),_:2},1032,["type"])]),_:1}),a(n,{prop:"classify",label:"流程类型"},{default:s(({row:e})=>[o(u(m($)[e.classify]),1)]),_:1}),a(n,{label:"操作"},{default:s(({row:e})=>[a(y,{link:"",type:"primary",onClick:V=>N(e)},{default:s(()=>l[1]||(l[1]=[o("详情")])),_:2},1032,["onClick"]),e.status===0?(k(),q(y,{key:0,link:"",type:"primary",onClick:V=>D(e.id)},{default:s(()=>l[2]||(l[2]=[o("撤回")])),_:2},1032,["onClick"])):z("",!0)]),_:1})]),_:1},8,["data"]),a(T,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=e=>i.value=e),direction:"rtl",size:"80%",title:"流程详情","destroy-on-close":""},{default:s(()=>[a(x,{ref_key:"flowFormEl",ref:p},null,512)]),_:1},8,["modelValue"])],64)}}});export{L as default};
